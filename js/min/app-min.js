function currentDrink(i){for(var e in drinks)drinks.hasOwnProperty(e)&&(e===i?drinks[e]=!0:drinks[e]=!1)}var counter=0,pouring,scaleBy,scaleByNeg,liquidHeight={coffee:"",steamedMilk:"",foamedMilk:""},origLiquidHeight={coffee:"",steamedMilk:"",foamedMilk:""},showLiquid=1,drinks={espresso:!0,doubleEspresso:!1,tripleEspresso:!1,cortado:!1,flatWhite:!1,dryCapuccino:!1,latte:!1,doubleLatte:!1,capuccino:!1};$(document).ready(function(){var i=document.getElementById("coffee"),e=propagating(new Hammer(i)),o=document.getElementById("steamed-milk"),s=propagating(new Hammer(o)),t=document.getElementById("foamed-milk"),n=propagating(new Hammer(t)),r=document.getElementById("container"),d=propagating(new Hammer(r)),l=$("#drink");e.on("press",function(e){liquidHeight.coffee=Math.floor($(i).height()),1===showLiquid?(drinks.espresso?origLiquidHeight.coffee=liquidHeight.coffee:(origLiquidHeight.coffee=liquidHeight.coffee/2,l.html("").hide().addClass("flip-in-x").html("espresso").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),currentDrink("espresso")),pouring=setInterval(function(){++counter,counter>=origLiquidHeight.coffee&&!drinks.doubleEspresso?(l.html("").hide().addClass("flip-in-x").html("double espresso").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),console.log("class set"),currentDrink("doubleEspresso")):counter>=2*origLiquidHeight.coffee&&(l.html("").hide().addClass("flip-in-x").html("triple espresso").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),clearInterval(pouring),currentDrink("tripleEspresso")),scaleBy=origLiquidHeight.coffee+counter,drinks.tripleEspresso||$(i).height(scaleBy)},1)):2===showLiquid?$(i).addClass("no-drinks"):3===showLiquid&&(origLiquidHeight.coffee=liquidHeight.coffee,drinks.latte&&(pouring=setInterval(function(){++counter,console.log(counter),counter>=origLiquidHeight.coffee&&(clearInterval(pouring),l.html("").hide().addClass("flip-in-x").html("double latte").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),console.log("class set"),currentDrink("doubleLatte")),scaleBy=origLiquidHeight.coffee+counter,drinks.doubleLatte||$(i).height(scaleBy)},1)),drinks.doubleLatte&&(counter=0,$(i).addClass("no-drinks")),drinks.capuccino&&(counter=0,$(i).addClass("no-drinks")))}),e.on("pressup",function(e){counter=0,clearInterval(pouring),1===showLiquid?(drinks.espresso&&$(i).height(origLiquidHeight.coffee),drinks.doubleEspresso?$(i).height(2*origLiquidHeight.coffee):drinks.tripleEspresso&&$(i).height(3*origLiquidHeight.coffee)):2===showLiquid?$(i).removeClass("no-drinks"):3===showLiquid&&(drinks.latte&&$(i).height(origLiquidHeight.coffee),(drinks.doubleLatte||drinks.capuccino)&&$(i).removeClass("no-drinks"))}),n.on("press",function(e){liquidHeight.foamedMilk=Math.floor($(t).height()),liquidHeight.coffee=Math.floor($(i).height()),2===showLiquid?(drinks.cortado&&(origLiquidHeight.foamedMilk=liquidHeight.foamedMilk,pouring=setInterval(function(){++counter,counter>=3*origLiquidHeight.foamedMilk&&(l.html("").hide().addClass("flip-in-x").html("dry capuccino").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),clearInterval(pouring),currentDrink("dryCapuccino")),scaleBy=origLiquidHeight.foamedMilk+counter,drinks.dryCapuccino||$(t).height(scaleBy)},1)),drinks.dryCapuccino&&$(t).addClass("no-drinks-try-tap")):3===showLiquid&&(drinks.latte&&(origLiquidHeight.foamedMilk=liquidHeight.foamedMilk,console.log(origLiquidHeight.foamedMilk,liquidHeight.foamedMilk),pouring=setInterval(function(){++counter,counter>=3.3*origLiquidHeight.foamedMilk&&(clearInterval(pouring),l.html("").hide().addClass("flip-in-x").html("capuccino").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),currentDrink("capuccino")),scaleBy=origLiquidHeight.foamedMilk+counter,drinks.capuccino||$(t).height(scaleBy)},1)),drinks.doubleLatte&&(origLiquidHeight.foamedMilk=liquidHeight.foamedMilk,origLiquidHeight.coffee=liquidHeight.coffee,pouring=setInterval(function(){++counter,counter>=3.3*origLiquidHeight.foamedMilk&&(clearInterval(pouring),currentDrink("capuccino"),l.html("").hide().addClass("flip-in-x").html("capuccino").show(),setTimeout(function(){l.removeClass("flip-in-x")},500)),scaleBy=origLiquidHeight.foamedMilk+counter,scaleByNeg=origLiquidHeight.coffee-counter,console.log("coffee height: "+scaleByNeg),console.log("actual coffee height: "+$(i).height()),drinks.capuccino||($(i).height(scaleByNeg),$(t).height(scaleBy))},1)),drinks.capuccino&&$(t).addClass("no-drinks"))}),n.on("pressup",function(i){counter=0,clearInterval(pouring),2===showLiquid?(drinks.cortado&&$(t).height(origLiquidHeight.foamedMilk),drinks.dryCapuccino&&$(t).removeClass("no-drinks-try-tap"),drinks.flatWhite):3===showLiquid&&(drinks.latte&&$(t).height(origLiquidHeight.foamedMilk),drinks.doubleLatte&&$(t).height(origLiquidHeight.foamedMilk),drinks.capuccino&&$(t).removeClass("no-drinks"))}),n.on("tap",function(i){counter=0,clearInterval(pouring),2===showLiquid&&(drinks.cortado||drinks.dryCapuccino)&&($(t).removeClass("half").css({height:""}).addClass("not-poured"),$(o).removeClass("not-poured").addClass("double"),l.html("").hide().addClass("flip-in-x").html("flat white").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),currentDrink("flatWhite"),i.stopPropagation())}),s.on("press",function(i){2===showLiquid?drinks.flatWhite&&$(o).addClass("no-drinks-try-tap"):3===showLiquid&&$(o).addClass("no-drinks")}),s.on("pressup",function(i){counter=0,clearInterval(pouring),2===showLiquid?drinks.flatWhite&&$(o).removeClass("no-drinks-try-tap"):3===showLiquid&&$(o).removeClass("no-drinks")}),s.on("tap",function(i){counter=0,clearInterval(pouring),2===showLiquid&&drinks.flatWhite&&($(o).removeClass("double").addClass("not-poured"),$(t).removeClass("not-poured").addClass("half"),l.html("").hide().addClass("flip-in-x").html("cortado").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),currentDrink("cortado"),i.stopPropagation())}),d.on("tap",function(e){showLiquid++,$(i).css({height:""}),$(t).css({height:""}),$(o).css({height:""}),scaleBy=0,2===showLiquid?($(t).removeClass("not-poured").addClass("half"),l.html("").hide().addClass("flip-in-x").html("cortado").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),currentDrink("cortado")):3===showLiquid?($(o).removeClass("not-poured").removeClass("double"),$(t).removeClass("half").css({height:""}).addClass("drop"),l.html("").hide().addClass("flip-in-x").html("latte").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),currentDrink("latte")):($(t).addClass("not-poured").removeClass("drop"),$(o).addClass("not-poured"),showLiquid=1,l.html("").hide().addClass("flip-in-x").html("espresso").show(),setTimeout(function(){l.removeClass("flip-in-x")},500),currentDrink("espresso"))})});